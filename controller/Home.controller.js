sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/m/MessageToast","sap/m/MessageBox"],function(e,t,n,a){"use strict";return e.extend("com.app.Application.controller.Home",{onInit:function(){this.onGet()},onGet:function(){var e=this.getOwnerComponent().getModel("apiModel");var t=e.sServiceUrl;var n=new sap.ui.model.json.JSONModel;var o=this;$.ajax({type:"GET",url:t+"/api/getAll",dataType:"json",async:false,success:function(e,t,n){o.getOwnerComponent().getModel("tableModel").setData(e)},error:function(e){a.show(e)}})},onCreate:function(){var e=this.getView();if(!this._pDialog){this._pDialog=t.load({id:e.getId(),name:"com.app.Application.fragments.Form",controller:this}).then(function(t){e.addDependent(t);return t})}this._pDialog.then(function(e){e.open()}.bind(this))},onClose:function(){this._pDialog.then(function(e){e.close()}.bind(this))},onCreateEmployee:function(){var e=this;var t=this.getOwnerComponent().getModel("apiModel");var n=t.sServiceUrl;var o=this.getView().byId("idForm");$.ajax({type:"POST",url:n+"/api/post",dataType:"json",data:JSON.stringify({pernr:parseInt(o.getContent()[1].getValue()),firstName:o.getContent()[3].getValue(),lastName:o.getContent()[5].getValue(),dateOfBirth:o.getContent()[7].getValue(),age:parseInt(o.getContent()[9].getValue()),gender:o.getContent()[11].getSelectedKey()}),async:false,success:function(t,n,a){e.onClose();e.onGet()},error:function(e){a.show(e.responseJSON.message)},contentType:"application/json"})},onDelete:function(){debugger;var e=this;var t=this.getView().byId("idTable");var n=t.getSelectedIndex();var o=this.getOwnerComponent().getModel("tableModel").getData()[n]._id;var i=this.getOwnerComponent().getModel("apiModel");var s=i.sServiceUrl;$.ajax({type:"DELETE",url:s+"/api/delete/"+o,async:false,success:function(t,n,a){e.onGet()},error:function(e){a.show(e.responseJSON.message)},contentType:"application/json"})},onEdit:function(e){var n=e.getSource();this.getView().setModel(n,"oImportEvent");var a=this.getView();if(!this._pEditDialog){this._pEditDialog=t.load({id:a.getId(),name:"com.app.Application.fragments.EditForm",controller:this}).then(function(e){a.addDependent(e);return e})}this._pEditDialog.then(function(e){this.configUpdateForm();e.open()}.bind(this))},onCloseEdit:function(){this._pEditDialog.then(function(e){e.close()}.bind(this))},configUpdateForm:function(){var e=this.getView().getModel("oImportEvent").getParent().getBindingContext("tableModel").getPath().slice(1);var t=this.getView().getModel("oImportEvent").getParent().getBindingContext("tableModel").getModel().getData()[e];var n=this.getView().byId("idFormEdit");n._aElements[1].setValue(t.pernr);n._aElements[3].setValue(t.firstName);n._aElements[5].setValue(t.lastName);n._aElements[7].setValue(t.dateOfBirth);n._aElements[9].setValue(t.age);if(t.gender==="male"){n._aElements[11].setSelectedKey("male")}else if(t.gender==="female"){n._aElements[11].setSelectedKey("female")}else if(t.gender==="other"){n._aElements[11].setSelectedKey("other")}},onUpdateEmployee:function(){debugger;var e=this;var t=this.getOwnerComponent().getModel("apiModel");var n=t.sServiceUrl;var o=this.getView().byId("idFormEdit");var i=this.getView().getModel("oImportEvent").getParent().getBindingContext("tableModel").getPath().slice(1);var s=this.getView().getModel("oImportEvent").getParent().getBindingContext("tableModel").getModel().getData()[i]._id;$.ajax({type:"PATCH",contentType:"application/json",url:n+"/api/update/"+s,dataType:"json",data:JSON.stringify({firstName:o._aElements[3].getValue(),lastName:o._aElements[5].getValue(),dateOfBirth:o._aElements[7].getValue(),age:parseInt(o._aElements[9].getValue()),gender:o._aElements[11].getSelectedKey()}),async:false,success:function(t,n,a){debugger;e.onCloseEdit();e.onGet()},error:function(e){debugger;a.show(e.responseJSON.message)}})}})});